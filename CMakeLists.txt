cmake_minimum_required(VERSION 3.5)
# Add at the top of your CMakeLists.txt
#set(CMAKE_VERBOSE_MAKEFILE ON CACHE BOOL "Verbose build output" FORCE)
# Add to your main CMakeLists.txt
#set(VERBOSE 1)

# Add project components directory to the search path
set(COMPONENT_DIRS ${CMAKE_CURRENT_LIST_DIR}/components/ $ENV{IDF_PATH}/components)

# Include the ESP-IDF project.cmake file
include($ENV{IDF_PATH}/tools/cmake/project.cmake)


# set(LIBRARY_SRCS # generated by: find ${ARDUINO_PACKAGES_PATH} -name '*.cpp' -o -name '*.c' | xargs dirname 2>/dev/null | sort | uniq
#     /home/mcaro/workbench/arduino-packages/libraries/Adafruit_BNO055/Adafruit_BNO055.cpp
#     /home/mcaro/workbench/arduino-packages/libraries/SimplePacketComs/src/client/PacketType.cpp
#     /home/mcaro/workbench/arduino-packages/libraries/SimplePacketComs/src/client/AbstractSimpleComsDevice.cpp
#     /home/mcaro/workbench/arduino-packages/libraries/SimplePacketComs/src/PacketEvent.cpp
#     /home/mcaro/workbench/arduino-packages/libraries/SimplePacketComs/src/SimplePacketComs.cpp
#     /home/mcaro/workbench/arduino-packages/libraries/ESP32Servo/src/ESP32Servo.cpp
#     /home/mcaro/workbench/arduino-packages/libraries/ESP32Servo/src/ESP32PWM.cpp
#     /home/mcaro/workbench/arduino-packages/libraries/Adafruit_BusIO/Adafruit_BusIO_Register.cpp
#     /home/mcaro/workbench/arduino-packages/libraries/Adafruit_BusIO/Adafruit_I2CDevice.cpp
#     /home/mcaro/workbench/arduino-packages/libraries/Adafruit_BusIO/Adafruit_GenericDevice.cpp
#     /home/mcaro/workbench/arduino-packages/libraries/Adafruit_BusIO/Adafruit_SPIDevice.cpp
#     /home/mcaro/workbench/arduino-packages/libraries/Esp32SimplePacketComs/src/device/UDPSimplePacketComs.cpp
#     /home/mcaro/workbench/arduino-packages/libraries/Esp32SimplePacketComs/src/device/UdpNameSearch.cpp
#     /home/mcaro/workbench/arduino-packages/libraries/Esp32SimplePacketComs/src/server/NameCheckerServer.cpp
#     /home/mcaro/workbench/arduino-packages/libraries/Esp32SimplePacketComs/src/server/UDPSimplePacket.cpp
#     /home/mcaro/workbench/arduino-packages/libraries/Adafruit_Unified_Sensor/Adafruit_Sensor.cpp
#     /home/mcaro/workbench/arduino-packages/libraries/Esp32WifiManager/src/wifi/WifiManager.cpp
# )

# Define the path to the Arduino packages
set(ARDUINO_PACKAGES_PATH "/home/mcaro/workbench/arduino-packages/libraries")

# Recursively find all .cpp and .c files in the specified path
file(GLOB_RECURSE LIBRARY_SRCS
    "${ARDUINO_PACKAGES_PATH}/*.cpp"
    "${ARDUINO_PACKAGES_PATH}/*.c"
)

# set(includedirs
#   variants/${CONFIG_ARDUINO_VARIANT}/
#   cores/esp32/
#   /home/mcaro/workbench/arduino-packages/libraries/SimplePacketComs/src/
# )
file(GLOB_RECURSE LIBRARY_SRCS
    "${ARDUINO_PACKAGES_PATH}/*.cpp"
    "${ARDUINO_PACKAGES_PATH}/*.c"
)

# include_directories(
#     /home/mcaro/workbench/arduino-packages/libraries/SimplePacketComs/src/
#     /home/mcaro/workbench/arduino-packages/libraries/Adafruit_Unified_Sensor/
#     /home/mcaro/workbench/arduino-packages/libraries/Adafruit_BNO055/
#     /home/mcaro/workbench/arduino-packages/libraries/ESP32Servo/src/
#     /home/mcaro/workbench/arduino-packages/libraries/Adafruit_BusIO/
# )


# Recursively find all .h files in the specified path
file(GLOB_RECURSE HEADER_FILES "${ARDUINO_PACKAGES_PATH}/*.h")

# Extract the directories containing the header files
set(INCLUDE_DIRS "")
foreach(header_file ${HEADER_FILES})
    get_filename_component(dir ${header_file} DIRECTORY)
    list(APPEND INCLUDE_DIRS ${dir})
endforeach()

# Remove duplicate directories
list(REMOVE_DUPLICATES INCLUDE_DIRS)

# Add include directories
include_directories(${INCLUDE_DIRS})

# Project declaration
project(esp32-blink-idf)
